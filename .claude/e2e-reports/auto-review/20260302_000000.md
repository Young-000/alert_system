# Auto E2E Review - 2026-03-02 00:00

## 이전 리뷰
- 파일: `20260226_000000.md`
- 이전 미해결: 5건 (권고사항, 수정 불필요)

## 리뷰 결과

| Phase | 상태 | 수정 | 미해결 |
|-------|------|------|--------|
| Phase 1: Build & Lint | ✅ 통과 | 0건 | 0 |
| Phase 2: Security | ✅ 수정 | 1건 (npm audit fix) | 0 |
| Phase 3: Performance | ✅ 수정 | 5건 (N+1 쿼리) | 0 |
| Phase 4: UX 핵심 플로우 | ✅ 수정 | 2건 (에러 표시) | 0 |
| Phase 5: Code Quality | ✅ 통과 | 0건 | 0 |
| Phase 6: Accessibility | ✅ 수정 | 9건 (터치 타겟) | 0 |
| Phase 7: DB & 스키마 | ✅ 통과 | 0건 | 0 |
| Phase 8: PWA & 알림 | ✅ 통과 | 0건 | 0 |
| Tests | ✅ 수정 | 1건 (테스트 assertion) | 0 |

## 수정 내역

### Phase 2: Security (1건)

1. `backend/package-lock.json` — `npm audit fix`로 critical `fast-xml-parser` CVE 해결. 나머지 29건은 @aws-sdk transitive deps (low/moderate/high, breaking major 필요).

### Phase 3: Performance — N+1 쿼리 수정 (5건)

2. `backend/src/domain/repositories/challenge.repository.ts` — `findTemplatesByIds(ids: string[])` 인터페이스 메서드 추가.
3. `backend/src/infrastructure/persistence/typeorm/challenge.repository.impl.ts` — `findTemplatesByIds` 구현 (`IN (:...ids)` 쿼리로 배치 조회).
4. `backend/src/application/use-cases/manage-challenge.use-case.ts` — `getActiveChallenges`, `getChallengeHistory`에서 루프 내 `findTemplateById` 호출을 `findTemplatesByIds` 배치 호출로 교체.
5. `backend/src/application/use-cases/evaluate-challenge.use-case.ts` — `execute` 메서드에서 동일 N+1 패턴 수정.
6. 관련 테스트 파일들 — `findTemplatesByIds` 목 설정 추가.

### Phase 4: UX 에러 복구 (2건)

7. `frontend/src/presentation/pages/CommuteTrackingPage.tsx` — 비로그인 에러가 아닌 일반 에러 메시지에 "닫기" 버튼 추가. 사용자가 에러를 확인하고 dismiss할 수 있도록 개선.
8. `frontend/src/presentation/pages/RouteSetupPage.tsx` + `route-setup/RouteListView.tsx` — 경로 목록 로드 실패 시 `loadError` 상태와 `onRetryLoad` 재시도 버튼을 RouteListView에 전달. 이전에는 로드 에러가 발생해도 빈 목록만 표시되어 사용자에게 피드백이 없었음.

### Phase 6: Accessibility — 터치 타겟 WCAG 2.5.5 (9건)

9. `frontend/src/presentation/styles/pages/alerts.css` — `.tag-remove` 28x28 → 44x44px
10. `frontend/src/presentation/styles/pages/routes.css` — `.search-clear` 32x32 → 44x44px
11. `frontend/src/presentation/styles/pages/routes.css` — `.sortable-stop-remove` 36x36 → 44x44px
12. `frontend/src/presentation/styles/pages/routes.css` — `.btn-icon` min-size 44x44px 추가
13. `frontend/src/presentation/styles/components.css` — `.notice-link` min-h 32 → 44px
14. `frontend/src/presentation/styles/components.css` — `.arrive-btn-mini` min-h 32 → 44px
15. `frontend/src/presentation/styles/pages/settings.css` — `.settings-toggle-btn` min-h 32 → 44px
16. `frontend/src/presentation/styles/pages/settings.css` — `.settings-delete-btn` min-h 32 → 44px
17. `frontend/src/presentation/styles/pages/home.css` — `.weekly-report-nav-btn` (mobile) 36x36 → 44x44px

### Tests (1건)

18. `frontend/src/presentation/hooks/use-commute-mode.test.ts:56` — `night` 모드 토글 assertion 수정. 실제 훅 로직에서 `night`은 `return`과 동일하게 비출퇴근 모드로 처리되므로, 토글 결과가 `commute`가 됨. 테스트가 잘못된 기대값(`return`)을 가지고 있었음.

## 미해결 이슈

### 이전 리뷰 권고사항 (변경 없음)

1. **[Phase 2] 알림톡 템플릿 ID 하드코딩** — `backend/src/infrastructure/messaging/solapi.service.ts`. 7개 템플릿 ID가 코드에 하드코딩. 공개 정보이므로 보안 위험 낮음. ConfigService 마이그레이션 권장.

2. **[Phase 5] 500 에러 메시지 통칭 처리** — API 클라이언트가 상태코드만 throw하므로 상세 메시지 전달 제한.

3. **[Phase 5] 외부 API 실패 시 폴백 부재** — 날씨/교통 API 실패 시 캐시 데이터 활용 미흡.

4. **[Phase 5] 새로고침 시 폼 상태 미보존** — RouteSetupPage, CommuteTrackingPage에서 sessionStorage 미활용.

## 검증 결과 상세

### Frontend
| 항목 | 결과 |
|------|------|
| lint | ✅ 에러 0 |
| typecheck | ✅ 에러 0 |
| build | ✅ gzip ~163KB (제한 500KB) |
| test | ✅ 33 suites, 468 passed |

### Backend
| 항목 | 결과 |
|------|------|
| lint | ✅ 에러 0 |
| typecheck | ✅ 에러 0 |
| build | ✅ 성공 |
| test | ✅ 75 suites, 892 passed, 10 skipped |

## Phase별 점검 요약

### Phase 1: Build & Lint
- Frontend: ESLint 0 error, TypeScript strict mode 통과, Vite build 성공 (~163KB gzip)
- Backend: ESLint 0 error, TypeScript 통과, NestJS build 성공

### Phase 2: Security
- JWT 인증 + bcrypt + timingSafeEqual ✅
- CORS 화이트리스트 ✅
- Helmet CSP ✅
- Rate Limiting (ThrottlerModule 60/min + 로그인 5/min + 가입 3/min) ✅
- ValidationPipe (whitelist + forbidNonWhitelisted) ✅
- 하드코딩 시크릿 없음, SSM Parameter Store 사용 ✅
- userId 검증: 모든 컨트롤러 일관 적용 ✅
- npm audit: critical fast-xml-parser 해결 ✅

### Phase 3: Performance
- 번들: 163KB gzip (500KB 제한 이내) ✅
- 14개 페이지 lazy loading + idle preload ✅
- API 캐싱: 날씨/미세먼지 1시간, 교통 30초 ✅
- N+1 쿼리: challenge use-cases 배치 조회로 수정 ✅

### Phase 4: UX 핵심 플로우
- 경로 설정: 비로그인→로그인 유도, 폼→리다이렉트, 삭제 확인 ✅
- 알림 설정: CRUD 완전, 삭제 확인 다이얼로그 ✅
- 출퇴근 추적: 세션 시작/체크포인트/완료/취소 플로우 ✅
- 미션: 인증/로딩/에러/빈 상태 처리 ✅
- CommuteTrackingPage 에러 닫기 버튼 추가 ✅
- RouteListView 로드 에러 표시+재시도 추가 ✅

### Phase 5: Code Quality
- `any` 타입: 프로덕션 코드 0건 ✅
- `console.log`: 0건 (warn/error만 사용) ✅
- Dead code: 없음 ✅
- React 안티패턴: 없음 ✅

### Phase 6: Accessibility
- 이미지 alt: N/A (SVG 아이콘 사용) ✅
- 아이콘 버튼 aria-label: 모두 적용 ✅
- 폼 라벨: 모든 input에 label/aria-label ✅
- 시맨틱 HTML: div-as-button 없음 ✅
- 키보드 접근성: onKeyDown + tabIndex 적용 ✅
- 포커스 스타일: focus-visible 존재 ✅
- 스킵 링크: 홈/로그인 페이지 적용 ✅
- 터치 타겟: 9개 요소 44px 미달 → 전부 수정 ✅

### Phase 7: DB & Schema
- 27개 엔티티 `alert_system` 스키마 사용 ✅
- camelCase 컬럼 snake_case 매핑 ✅
- userId 인덱스 + 컨트롤러 권한검사 ✅

### Phase 8: PWA & Notifications
- VitePWA injectManifest + 캐싱 전략 ✅
- VAPID 푸시 알림 + 서비스워커 ✅
- EventBridge Scheduler CRUD + toggle ✅

## 통계
- 총 체크: ~90건 / 통과: 72건 / 수정: 18건 / 미해결: 4건 (권고사항)
