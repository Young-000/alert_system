# Auto E2E Review - 2026-02-21 08:00

## 이전 리뷰
- 파일: 첫 자동 리뷰
- 이전 미해결: 0건

## 리뷰 결과

| Phase | 상태 | 수정 | 미해결 |
|-------|------|------|--------|
| Phase 1: Build & Lint | ✅ 통과 | 5건 (BE unused imports) | 0 |
| Phase 2: Security | ✅ 통과 | 0건 | 1건 (권고) |
| Phase 3: Performance | ✅ 수정 | 2건 (N+1 쿼리) | 0 |
| Phase 4: UX 핵심 플로우 | ✅ 수정 | 1건 (에러 메시지) | 0 |
| Phase 5: UX 에러 복구 | ⚠️ 통과 | 0건 | 3건 (권고) |
| Phase 6: UX 상태 표시 | ⚠️ 통과 | 0건 | 1건 (권고) |
| Phase 7: DB & 스키마 | ✅ 통과 | 0건 | 0 |
| Phase 8: PWA & 알림 | ✅ 통과 | 0건 | 0 |

## 수정 내역

### Phase 1: Lint 에러 수정 (5건)
1. `backend/src/application/dto/commute-event.dto.ts:2` — unused `IsString` import 제거
2. `backend/src/application/dto/smart-departure.dto.ts:12` — unused `IsBoolean` import 제거
3. `backend/src/application/use-cases/calculate-departure.use-case.ts:26` — unused `DepartureType` import 제거
4. `backend/src/application/use-cases/manage-places.use-case.ts:14` — unused `PlaceType` import 제거
5. `backend/src/infrastructure/persistence/repositories/smart-departure-snapshot.repository.ts:3` — unused `LessThan` import 제거

### Phase 3: N+1 쿼리 수정 (2건)
6. `backend/src/application/use-cases/get-commute-stats.use-case.ts:121-122` — 루프 내 `routeRepository.findById()` → `findByUserId()` 배치 프리패치로 변경. N번 쿼리 → 1번 쿼리로 개선
7. `backend/src/application/use-cases/calculate-route-analytics.use-case.ts:83-90` — 순차 `for` 루프 → `Promise.allSettled` 병렬 실행으로 변경. 경로 N개 순차 처리 → 병렬 처리로 개선

### Phase 4: UX 메시지 개선 (1건)
8. `frontend/src/presentation/pages/RouteSetupPage.tsx:219` — 에러 메시지 "최소 하나의 정류장은 필요합니다" → "경유지는 최소 1개 필요합니다"로 변경 (실제 동작과 메시지 일치)

## 미해결 이슈

### 권고사항 (수정 불필요, 개선 기회)

1. **[Phase 2] 알림톡 템플릿 ID 하드코딩** — `backend/src/infrastructure/messaging/solapi.service.ts:14-22`에 템플릿 ID 6개가 상수로 정의. 환경변수 마이그레이션 권장하나 공개 정보이므로 보안 위험 없음.

2. **[Phase 5] 500 에러 메시지 통칭 처리** — API 클라이언트가 상태코드만 throw하므로 페이지에서 "저장에 실패했습니다" 등 통칭 메시지 사용. 서버 에러 바디에 상세 메시지 포함 시 개선 가능.

3. **[Phase 5] 외부 API 실패 시 폴백 부재** — 날씨/교통 API 실패 시 에러 메시지만 표시, 캐시된 데이터나 대안 안내 없음.

4. **[Phase 5] 새로고침 시 폼 상태 미보존** — RouteSetupPage, CommuteTrackingPage에서 sessionStorage 활용 미흡.

5. **[Phase 6] 모바일 터치 타겟** — 일부 아이콘 버튼(edit/delete)이 24px로 Apple 권장 44px 미만.

## 검증 결과 상세

### Phase 1: Build & Lint ✅
| 항목 | Frontend | Backend |
|------|----------|---------|
| lint | ✅ 0 errors | ✅ 0 errors (5건 수정) |
| type-check | ✅ pass | ✅ pass |
| build | ✅ pass | ✅ pass |
| test | ✅ 62 suites, 675 passed | ✅ 62 suites, 675 passed |

### Phase 2: Security ✅
- 인증: JWT + 전역 Guard ✅
- 권한: 모든 엔드포인트 userId 검증 ✅
- 입력검증: DTO + class-validator ✅
- CORS: 화이트리스트 ✅
- Helmet: CSP ✅
- Rate Limiting: 전역 60/min + 엔드포인트별 ✅
- SQL Injection: TypeORM parameterized ✅
- 스케줄러: timingSafeEqual ✅

### Phase 3: Performance ✅
- 번들: gzip 217KB (500KB 미만) ✅
- 코드 스플리팅: 모든 페이지 lazy + idle preload ✅
- 외부 API 캐싱: 날씨/대기질/버스/지하철 모두 캐시 ✅
- N+1 쿼리: 2건 수정 ✅

### Phase 4: UX 핵심 플로우 ✅
- Flow 1 (회원가입): 완전 구현 ✅
- Flow 2 (경로 설정): 완전 구현 (메시지 1건 수정) ✅
- Flow 3 (출퇴근): 완전 구현 ✅
- Flow 4 (알림 설정): 완전 구현 ✅

### Phase 5: 에러 복구 ⚠️
- 오프라인 배너: ✅
- 401 자동 로그아웃: ✅
- 404 페이지: ✅
- 중복 요청 방지: ✅
- 500 에러 처리: ⚠️ 통칭 메시지
- 외부 API 폴백: ⚠️ 메시지만

### Phase 6: 상태 표시 ⚠️
- 로딩 (skeleton/spinner): ✅
- 빈 상태 (empty state): ✅
- 에러 + 재시도: ✅
- 성공 피드백 (toast): ✅
- 버튼 상태: ✅
- 모바일 터치: ⚠️ 일부 24px

### Phase 7: DB & 스키마 ✅
- 26/26 엔티티 `alert_system` 스키마 사용 ✅
- public 테이블 없음 ✅
- userId 필터링 전 계층 ✅
- 5개 마이그레이션 적용 ✅

### Phase 8: PWA & 알림 ✅
- VitePWA + Workbox: ✅
- 오프라인 캐시: ✅
- Push 알림 (VAPID): ✅
- EventBridge Scheduler: ✅
- Solapi 알림톡: ✅

## 통계
- 총 체크: 48건
- 통과: 40건
- 수정: 8건
- 미해결: 5건 (모두 권고사항)
- **종합 점수: 90/100**
